function RGBColor(color_string){color_string=color_string.toString(),this.ok=!1,"#"==color_string.charAt(0)&&(color_string=color_string.substr(1,6)),color_string=color_string.replace(/ /g,""),color_string=color_string.toLowerCase();var simple_colors={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var key in simple_colors)color_string==key&&(color_string=simple_colors[key]);for(var color_defs=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(bits){return[parseInt(bits[1]),parseInt(bits[2]),parseInt(bits[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(bits){return[parseInt(bits[1],16),parseInt(bits[2],16),parseInt(bits[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(bits){return[parseInt(bits[1]+bits[1],16),parseInt(bits[2]+bits[2],16),parseInt(bits[3]+bits[3],16)]}}],i=0;i<color_defs.length;i++){var re=color_defs[i].re,processor=color_defs[i].process,bits=re.exec(color_string);bits&&(channels=processor(bits),this.r=channels[0],this.g=channels[1],this.b=channels[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var r=this.r.toString(16),g=this.g.toString(16),b=this.b.toString(16);return 1==r.length&&(r="0"+r),1==g.length&&(g="0"+g),1==b.length&&(b="0"+b),"#"+r+g+b},this.getHelpXML=function(){for(var examples=new Array,i=0;i<color_defs.length;i++)for(var example=color_defs[i].example,j=0;j<example.length;j++)examples[examples.length]=example[j];for(var sc in simple_colors)examples[examples.length]=sc;var xml=document.createElement("ul");xml.setAttribute("id","rgbcolor-examples");for(var i=0;i<examples.length;i++)try{var list_item=document.createElement("li"),list_color=new RGBColor(examples[i]),example_div=document.createElement("div");example_div.style.cssText="margin: 3px; border: 1px solid black; background:"+list_color.toHex()+"; "+"color:"+list_color.toHex(),example_div.appendChild(document.createTextNode("test"));var list_item_value=document.createTextNode(" "+examples[i]+" -> "+list_color.toRGB()+" -> "+list_color.toHex());list_item.appendChild(example_div),list_item.appendChild(list_item_value),xml.appendChild(list_item)}catch(e){}return xml}}caseConverter=function(){var dotCase=function(string){return separatorCase(string,".")},classCase=function(string){return separatorCase(string,"_").replace(/(?:^|_|\-|\/)(.)/g,function(match,c){return c.toUpperCase()})},namespaceCase=function(string){return separatorCase(string,".").replace(/(^|_|\.|\-|\/)(.)/g,function(match,p,c){return p+c.toUpperCase()})},constantCase=function(string){return separatorCase(string,"_").replace(/[a-z]/g,function(c){return c.toUpperCase()})},camelCase=function(string){return separatorCase(string,"_").replace(/[-_\.\/\s]+(.)?/g,function(match,c){return c.toUpperCase()})},titleCase=function(string){return separatorCase(string," ").replace(/(?:^|\s)\S/g,function(c){return c.toUpperCase()})},snakeCase=function(string){return separatorCase(string,"_")},pathCase=function(string){return this.separatorCase(string,"/")},paramCase=function(string){return this.separatorCase(string,"-")},separatorCase=function(string,separator){return clean(trim(string),separator).replace(/([a-z\d])([A-Z]+)/g,"$1"+separator+"$2").replace(/[-\.\/\_\s]+/g,separator).toLowerCase()},clean=function(string,separator){return string.replace(/\W+/g,separator||" ")},trim=function(string){return string.replace(/^\W+|\W+$/g,"")};return{dotCase:dotCase,classCase:classCase,namespaceCase:namespaceCase,constantCase:constantCase,camelCase:camelCase,titleCase:titleCase,snakeCase:snakeCase,pathCase:pathCase,paramCase:paramCase}}(),function(window,undef){function parseXMLString(strXML){var xmlDoc=NULL,out=NULL,isParsed=TRUE;try{xmlDoc="DOMParser"in window?new DOMParser:new ActiveXObject("MSXML2.DOMDocument"),xmlDoc.async=FALSE}catch(e){throw new Error("XML Parser could not be instantiated")}if("parseFromString"in xmlDoc?(out=xmlDoc.parseFromString(strXML,"text/xml"),isParsed="parsererror"!==out.documentElement.tagName):(isParsed=xmlDoc.loadXML(strXML),out=isParsed?xmlDoc:FALSE),!isParsed)throw new Error("Error parsing XML string");return out}"".trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,"")});var XMLConverter,module,NULL=null,FALSE=!1,TRUE=!0,NODE_TYPES={Element:1,Attribute:2,Text:3,CDATA:4,Root:9,Fragment:11};XMLConverter={isUnsafe:FALSE,isXML:function(o){return"object"==typeof o&&o.nodeType!==undef},getRoot:function(doc){return doc.nodeType===NODE_TYPES.Root?doc.documentElement:doc.nodeType===NODE_TYPES.Fragment?doc.firstChild:doc},convert:function(xml){var root,out={},xdoc="string"==typeof xml?parseXMLString(xml):this.isXML(xml)?xml:undef;if(!xdoc)throw new Error("Unable to parse XML");return xdoc.nodeType===NODE_TYPES.Text||xdoc.nodeType===NODE_TYPES.CDATA?xdoc.nodeValue:(root=this.getRoot(xdoc),out[caseConverter.camelCase(root.nodeName)]={},this.process(root,out[caseConverter.camelCase(root.nodeName)]),out)},process:function(node,buff){var child,attr,name,att_name,value,i,j,tmp,iMax;if(node.hasChildNodes())for(iMax=node.childNodes.length,i=0;iMax>i;i++)switch(child=node.childNodes[i],child.nodeType){case NODE_TYPES.Text:buff.Text=buff.Text?buff.Text+child.nodeValue.trim():child.nodeValue.trim();break;case NODE_TYPES.CDATA:value=child[child.text?"text":"nodeValue"],buff.Text=buff.Text?buff.Text+value:value;break;case NODE_TYPES.Element:name=caseConverter.camelCase(child.nodeName),tmp={},name in buff?buff[name].length?(this.process(child,tmp),buff[name].push(tmp)):(this.process(child,tmp),buff[name]=[buff[name],tmp]):(this.process(child,tmp),buff[name]=tmp)}if(node.attributes.length)for(j=node.attributes.length-1;j>=0;j--)attr=node.attributes[j],att_name=caseConverter.camelCase(attr.name.trim()),value=attr.value,buff[(this.isUnsafe?"":"@")+att_name]=value}},module={xmlToJSON:function(xml,unsafe){return XMLConverter.isUnsafe=unsafe!==undef?unsafe:FALSE,XMLConverter.convert(xml)}},window.xml=window.xml||module}(window);var pathvisio={};pathvisio.data={},pathvisio.data.current={},pathvisio.data.current.svgSelector=null,pathvisio.data.current.svg=null,pathvisio.data.pathways=[],pathvisio.helpers=function(){function splitStringByNewLine(str){return str.split(/\r\n|\r|\n/g)}function cloneNode(selector){var node=d3.select(selector).node();return d3.select(node.parentNode.insertBefore(node.cloneNode(!0),node.nextSibling))}function getUrlParam(name){var parameter=decodeURIComponent((new RegExp("[?|&]"+name+"="+"([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null;return null!==parameter?parameter:(console.warn("Warning: URL parameter is null."),null)}function convertToArray(object){if("[object Object]"===Object.prototype.toString.call(object)){var array=[];return array.push(object),array}if("[object Array]"===Object.prototype.toString.call(object))return object;if("[object String]"===Object.prototype.toString.call(object)){var array=[];return array.push(object),array}}function getWindowDimensions(){var winW=630,winH=460;return document.body&&document.body.offsetWidth&&(winW=document.body.offsetWidth,winH=document.body.offsetHeight),"CSS1Compat"==document.compatMode&&document.documentElement&&document.documentElement.offsetWidth&&(winW=document.documentElement.offsetWidth,winH=document.documentElement.offsetHeight),window.innerWidth&&window.innerHeight&&(winW=window.innerWidth,winH=window.innerHeight),{width:winW,height:winH}}return{splitStringByNewLine:splitStringByNewLine,getUrlParam:getUrlParam,cloneNode:cloneNode,convertToArray:convertToArray,getUrlParam:getUrlParam,getWindowDimensions:getWindowDimensions}}(),pathvisio.pathway=function(){function gpml2json(gpml,callback){self.gpml=gpml,console.log("GPML"),console.log(gpml);var pathway=pathvisio.data.pathways[pathvisio.data.current.svgSelector];pathway=self.pathway=xml.xmlToJSON(gpml,!0).pathway,console.log("raw json from xml2json"),console.log(xml.xmlToJSON(gpml,!0).pathway);try{xmlns=pathway.xmlns}catch(e){return console.log(e.message),void 0}var gpmlXmlnsSupported="http://pathvisio.org/GPML/2013a",gpmlXmlnsIdentifier="/GPML/";if(-1===xmlns.indexOf(gpmlXmlnsIdentifier))return alert("Pathvisio.js does not support the data format provided. Please convert to GPML and retry."),console.log("Pathvisio.js does not support the data format provided. Please convert to GPML and retry."),void 0;xmlns!=gpmlXmlnsSupported&&alert("Pathvisio.js may not fully support the version of GPML provided (xmlns: "+xmlns+"). Please convert to the supported version of GPML (xmlns: "+gpmlXmlnsSupported+")."),pathway.boardWidth=pathway.graphics.boardWidth,pathway.boardHeight=pathway.graphics.boardHeight,pathway.infoBox.x=0,delete pathway.infoBox.centerX,pathway.infoBox.y=0,delete pathway.infoBox.centerY;try{pathway.hasOwnProperty("comment")?(pathway.comments=pathvisio.helpers.convertToArray(pathway.comment),delete pathway.comment,pathway.comments.forEach(function(){})):console.log("No element(s) named 'comment' found in this gpml file.")}catch(e){console.log("Error converting comment to json: "+e.message)}try{pathway.hasOwnProperty("group")?(pathway.groups=pathvisio.helpers.convertToArray(pathway.group),delete pathway.group,pathway.groups.forEach(function(element){element.style=element.hasOwnProperty("style")?element.style.toLowerCase():"none"})):console.log("No element(s) named 'group' found in this gpml file.")}catch(e){console.log("Error converting group to json: "+e.message)}try{pathway.hasOwnProperty("graphicalLine")?(graphicalLines=pathvisio.helpers.convertToArray(pathway.graphicalLine),delete pathway.graphicalLine,void 0===pathway.edges&&(pathway.edges=[]),graphicalLines.forEach(function(element){element.edgeType="graphical-line",pathway.edges.push(element)})):console.log("No element(s) named 'graphicalLine' found in this gpml file.")}catch(e){console.log("Error converting graphicalLine to json: "+e.message)}try{if(pathway.hasOwnProperty("interaction")){var interactions=pathvisio.helpers.convertToArray(pathway.interaction);delete pathway.interaction,void 0===pathway.edges&&(pathway.edges=[]),interactions.forEach(function(element){element.edgeType="interaction",pathway.edges.push(element)}),self.interactions=interactions,self.edges=pathway.edges}else console.log("No element(s) named 'interaction' found in this gpml file.")}catch(e){console.log("Error converting interaction to json: "+e.message)}try{pathway.hasOwnProperty("edges")?pathway.edges=pathvisio.pathway.edge.gpml2json(pathway.edges):console.log("No element(s) named 'edges' found in this gpml file.")}catch(e){console.log("Error converting edges to json: "+e.message)}var dataNodeTypeMappings={GeneProduct:"gene-product",Metabolite:"metabolite",Pathway:"pathway",Protein:"protein",Rna:"rna"};try{if(pathway.hasOwnProperty("dataNode")){var dataNodes=pathvisio.helpers.convertToArray(pathway.dataNode);delete pathway.dataNode,dataNodes.forEach(function(element){element.elementType="data-node",element.dataNodeType=dataNodeTypeMappings.hasOwnProperty(element.type)?dataNodeTypeMappings[element.type]:"unknown",delete element.type,element.hasOwnProperty("xref")&&(element.xref.database||element.xref.id?(element.xRef=element.xref,delete element.xref):delete element.xref)}),pathway.nodes=pathway.hasOwnProperty("nodes")?pathway.nodes.concat(dataNodes):dataNodes}else console.log("No element(s) named 'dataNode' found in this gpml file.")}catch(e){console.log("Error converting dataNode to json: "+e.message)}try{if(pathway.hasOwnProperty("label")){var labels=self.labels=pathvisio.helpers.convertToArray(pathway.label);delete pathway.label,labels.forEach(function(element){element.elementType="label"}),pathway.nodes=pathway.hasOwnProperty("nodes")?pathway.nodes.concat(labels):labels}else console.log("No element(s) named 'label' found in this gpml file.")}catch(e){console.log("Error converting label to json: "+e.message)}try{if(pathway.hasOwnProperty("shape")){var shapes=pathvisio.helpers.convertToArray(pathway.shape);delete pathway.shape,shapes.forEach(function(element){element.elementType="shape"}),pathway.nodes=pathway.hasOwnProperty("nodes")?pathway.nodes.concat(shapes):shapes}else console.log("No element(s) named 'shape' found in this gpml file.")}catch(e){console.log("Error converting shape to json: "+e.message)}try{pathway.hasOwnProperty("nodes")?pathway.nodes=pathvisio.pathway.node.gpml2json(pathway.nodes):console.log("No element(s) named 'nodes' found in this gpml file.")}catch(e){console.log("Error converting nodes to json: "+e.message)}try{pathway.hasOwnProperty("biopaxRef")?(pathway.biopaxRefs=pathvisio.helpers.convertToArray(pathway.biopaxRef),delete pathway.biopaxRef):console.log("No element(s) named 'biopaxRef' for the element 'pathway' found in this gpml file.")}catch(e){console.log("Error converting biopaxRef to json: "+e.message)}try{pathway.hasOwnProperty("biopax")?(pathway.biopax.bpPublicationXrefs=pathvisio.helpers.convertToArray(pathway.biopax.bpPublicationXref),delete pathway.biopax.bpPublicationXref):console.log("No element(s) named 'biopax' found in this gpml file.")}catch(e){console.log("Error converting biopax to json: "+e.message)}console.log("JSON:"),console.log(pathway),console.log("pathvisio.data.pathways[pathvisio.data.current.svgSelector]"),console.log(pathvisio.data.pathways[pathvisio.data.current.svgSelector]),delete pathway.graphics,pathvisio.data.pathways[pathvisio.data.current.svgSelector]=pathway,callback(pathvisio.data.pathways[pathvisio.data.current.svgSelector]=pathway)}function getJson(url,mimeType,callback){if(!url){var error="Error: URL not specified.";return console.warn(error),error}mimeType||(mimeType="application/xml"),pathvisio.data.current.svgSelector||(pathvisio.data.current.svgSelector=(new Date).toString()),console.log("callback"),console.log(callback),$.get(url,mimeType,function(data){pathvisio.pathway.gpml2json(data,function(json){callback(json)})})}function draw(data){function dragmove(d){d.x=d3.event.x,d.y=d3.event.y,d3.select(this).attr("x",d3.event.x).attr("y",d3.event.y)}if(!data)return console.warn("Error: No data entered as input."),"Error";d3.behavior.drag().on("drag",dragmove),pathvisio.data.current.svg.attr("width",data.boardWidth),pathvisio.data.current.svg.attr("height",data.boardHeight),pathvisio.data.pathways[pathvisio.data.current.svgSelector].biopaxRefs&&pathvisio.data.current.svg.select("#viewport").selectAll(".pathway-publication-xref-text").data(pathvisio.data.pathways[pathvisio.data.current.svgSelector].biopaxRefs).enter().append("text").attr("id",function(d){return"pathway-publication-xref-text-"+d}).attr("x",0).attr("y",0).attr("transform",function(d,i){return"translate("+(200+12*i)+" "+12+")"}).attr("class","pathway-publication-xref-text").attr("style","").text(function(d){var index=0,rdfId=null;do rdfId=pathvisio.data.pathways[pathvisio.data.current.svgSelector].biopax.bpPublicationXrefs[index].rdfId,index+=1;while(rdfId!==d.Text&&index<pathvisio.data.pathways[pathvisio.data.current.svgSelector].biopax.bpPublicationXrefs.length);return index}),self.symbolsAvailable=pathvisio.data.current.svg.selectAll("symbol");var markersAvailable=markersAvailable=pathvisio.data.current.svg.selectAll("marker");pathvisio.pathway.group.drawAll(),pathvisio.pathway.edge.drawAll(),pathvisio.pathway.node.drawAll(),pathvisio.pathway.infoBox.draw()}function load(svgSelector,url){if(!svgSelector)return console.warn("Error: No SVG template selector specified."),"Error";pathvisio.data.current.svgSelector=svgSelector,pathvisio.data.current.svg=d3.select(svgSelector);var svgCount=pathvisio.data.current.svg.length;return 1!==svgCount?(console.warn("Error: "+svgCount+' SVG template(s) returned with selector "'+svgSelector+'". Please redefined selector so only 1 result is returned.'),"Error"):(console.log("Successfully loaded SVG pathway template."),url?(getJson(url,null,function(data){draw(data)}),void 0):(console.warn("Error: No url specified for GPML or JSON data."),"No URL specified."))}return{draw:draw,load:load,getJson:getJson,gpml2json:gpml2json}}(),pathvisio.pathway.group=function(){function drawAll(){if(pathvisio.data.pathways[pathvisio.data.current.svgSelector].hasOwnProperty("groups")){var validGroups=pathvisio.data.pathways[pathvisio.data.current.svgSelector].groups.filter(function(el){var groupId=el.groupId;return pathvisio.data.pathways[pathvisio.data.current.svgSelector].nodes.filter(function(el){return el.groupRef===groupId}).length>0});pathvisio.data.current.svg.select("#viewport").selectAll("use.group").data(validGroups).enter().append("path").attr("id",function(d){return"group-"+d.graphId}).attr("class",function(d){return"group group-"+d.style}).attr("d",function(d){var groupDimensions=getDimensions(d.groupId);if("none"===d.style||"group"===d.style||"pathway"===d.style)var pathData="M "+groupDimensions.x+" "+groupDimensions.y+" L "+(groupDimensions.x+groupDimensions.width)+" "+groupDimensions.y+" L "+(groupDimensions.x+groupDimensions.width)+" "+(groupDimensions.y+groupDimensions.height)+" L "+groupDimensions.x+" "+(groupDimensions.y+groupDimensions.height)+" Z";else if("complex"===d.style)var pathData="M "+(groupDimensions.x+20)+" "+groupDimensions.y+" L "+(groupDimensions.x+groupDimensions.width-20)+" "+groupDimensions.y+" L "+(groupDimensions.x+groupDimensions.width)+" "+(groupDimensions.y+20)+" L "+(groupDimensions.x+groupDimensions.width)+" "+(groupDimensions.y+groupDimensions.height-20)+" L "+(groupDimensions.x+groupDimensions.width-20)+" "+(groupDimensions.y+groupDimensions.height)+" L "+(groupDimensions.x+20)+" "+(groupDimensions.y+groupDimensions.height)+" L "+groupDimensions.x+" "+(groupDimensions.y+groupDimensions.height-20)+" L "+groupDimensions.x+" "+(groupDimensions.y+20)+" Z";else var pathData="M "+groupDimensions.x+" "+groupDimensions.y+" L "+(groupDimensions.x+groupDimensions.width)+" "+groupDimensions.y+" L "+(groupDimensions.x+groupDimensions.width)+" "+(groupDimensions.y+groupDimensions.height)+" L "+groupDimensions.x+" "+(groupDimensions.y+groupDimensions.height)+" Z";return pathData})}}function getDimensions(groupId){var groupMembers=pathvisio.data.pathways[pathvisio.data.current.svgSelector].nodes.filter(function(el){return el.groupRef===groupId}),group={},margin=12;return group.x=d3.min(groupMembers,function(el){return el.x})-margin,group.y=d3.min(groupMembers,function(el){return el.y})-margin,group.width=d3.max(groupMembers,function(el){return el.x+el.width})-group.x+margin,group.height=d3.max(groupMembers,function(el){return el.y+el.height})-group.y+margin,group}return{drawAll:drawAll,getDimensions:getDimensions}}(),pathvisio.pathway.infoBox=function(){function draw(){var infoBox=[];pathvisio.data.pathways[pathvisio.data.current.svgSelector].hasOwnProperty("name")&&infoBox.push({key:"Title",value:pathvisio.data.pathways[pathvisio.data.current.svgSelector].name}),pathvisio.data.pathways[pathvisio.data.current.svgSelector].hasOwnProperty("license")&&infoBox.push({key:"Availability",value:pathvisio.data.pathways[pathvisio.data.current.svgSelector].license}),pathvisio.data.pathways[pathvisio.data.current.svgSelector].hasOwnProperty("lastModified")&&infoBox.push({key:"Last modified",value:pathvisio.data.pathways[pathvisio.data.current.svgSelector].lastModified}),pathvisio.data.pathways[pathvisio.data.current.svgSelector].hasOwnProperty("organism")&&infoBox.push({key:"Organism",value:pathvisio.data.pathways[pathvisio.data.current.svgSelector].organism});var infoBoxElements=pathvisio.data.current.svg.select("#viewport").selectAll("text.info-box").data(infoBox).enter().append("text").attr("id",function(d,i){return"info-box-"+i}).attr("class","info-box").attr("x",0).attr("y",function(d,i){return 14+14*i});infoBoxElements.append("tspan").attr("class","info-box-property-name").text(function(d){return d.key+": "}),infoBoxElements.append("tspan").text(function(d){return d.value})}return{draw:draw}}(),pathvisio.pathway.node=function(){function gpml2json(rawJsonNodes){try{rawJsonNodes.forEach(function(element){if(element.hasOwnProperty("comment")&&(element.comments=pathvisio.helpers.convertToArray(element.comment),delete element.comment),element.hasOwnProperty("xref")&&(element.xref.database||element.xref.id?(element.xref=element.xRef,delete element.xref):delete element.xref),element.graphics.hasOwnProperty("zorder")&&(element.zIndex=parseFloat(element.graphics.zorder)),element.x=parseFloat(element.graphics.centerX)-parseFloat(element.graphics.width)/2,element.y=parseFloat(element.graphics.centerY)-parseFloat(element.graphics.height)/2,element.width=parseFloat(element.graphics.width),element.height=parseFloat(element.graphics.height),element.graphics.hasOwnProperty("color")){var color=new RGBColor(element.graphics.color);color.ok?element.stroke=color.toHex():(console.warn("Invalid Color encountered. Setting Color to black."),element.fill="#000000")}if(element.symbolType=element.graphics.hasOwnProperty("shapeType")?shapeMappings[element.graphics.shapeType]:"data-node"===element.elementType?"rectangle":"none",element.graphics.hasOwnProperty("fillColor"))if(element.graphics.fillColor=element.graphics.fillColor.toLowerCase(),"transparent"===element.graphics.fillColor)element.fillOpacity=0;else{var fill=new RGBColor(element.graphics.fillColor);fill.ok?element.fill=fill.toHex():(console.warn("Invalid FillColor encountered. Setting FillColor to gray."),element.fill="#999999"),"none"!==element.symbolType&&(element.fillOpacity=1)}if(element.graphics.hasOwnProperty("lineThickness")&&(element.strokeWidth=element.graphics.lineThickness),element.graphics.hasOwnProperty("lineStyle")&&(element.strokeStyle=element.graphics.lineStyle.toLowerCase(),"broken"===element.strokeStyle&&(element.strokeStyle="dashed")),element.hasOwnProperty("attribute")&&(element.attributes=pathvisio.helpers.convertToArray(element.attribute),delete element.attribute,element.attributes.forEach(function(el){"org.pathvisio.DoubleLineProperty"===el.key&&"Double"===el.value?(console.log("double"),console.log(el),element.strokeStyle="double"):"org.pathvisio.CellularComponentProperty"===el.key&&"None"!==el.value&&(element.cellularComponent=el.value)}),delete element.attributes),element.graphics.hasOwnProperty("rotation")&&(element.rotation=element.graphics.rotation*(180/Math.PI)),element.hasOwnProperty("textLabel"))if(element.textLabel){var text=element.textLabel.toString().replace("&#xA;","\r\n");if(delete element.textLabel,element.textLabel={},element.textLabel.text=text,element.hasOwnProperty("stroke")&&(element.textLabel.fill=element.stroke),element.graphics.hasOwnProperty("fontSize"))var fontSize=element.graphics.fontSize;else var fontSize=10;element.textLabel.fontSize=fontSize,element.graphics.hasOwnProperty("fontName")&&(element.textLabel.fontFamily=element.graphics.fontName),element.graphics.hasOwnProperty("fontWeight")&&(element.textLabel.fontWeight=element.graphics.fontWeight.toLowerCase()),element.graphics.hasOwnProperty("fontStyle")&&(element.textLabel.fontStyle=element.graphics.fontStyle.toLowerCase()),element.textLabel.textAnchor=alignToAnchorMappings.hasOwnProperty(element.graphics.align)?alignToAnchorMappings[element.graphics.align]:"middle",element.textLabel.vAlign=element.graphics.hasOwnProperty("valign")?element.graphics.valign.toLowerCase():"top"}else delete element.textLabel;try{element.hasOwnProperty("biopaxRef")?(element.biopaxRefs=pathvisio.helpers.convertToArray(element.biopaxRef),delete element.biopaxRef):console.log("No element(s) named 'biopaxRef' found for this node in this gpml file.")}catch(e){console.log("Error converting node's biopaxRef to json: "+e.message)}delete element.graphics});var validJsonNodes=rawJsonNodes.sort(function(a,b){return a.zIndex-b.zIndex});return validJsonNodes}catch(e){return console.log("Error converting labelable elements to json: "+e.message),e}}function drawAll(){var nodesContainer=pathvisio.data.current.svg.select("#viewport").selectAll("g.nodes-container").data(pathvisio.data.pathways[pathvisio.data.current.svgSelector].nodes).enter().append("g").attr("id",function(d){return"nodes-container-"+d.graphId}).attr("transform",function(d){return"translate("+d.x+" "+d.y+")"}).attr("class","nodes-container").on("click",function(d){"data-node"===d.elementType&&pathvisio.pathway.xRef.displayData(d.graphId)});nodesContainer.each(function(d,i){var node=d3.select(this).append("use").attr("id",function(d){return"node-"+d.graphId}).attr("transform",function(d){var transform="scale(1)";return d.hasOwnProperty("rotation")&&(transform="rotate("+d.rotation+" "+d.width/2+" "+d.height/2+")"),transform}).attr("class",function(d){var styleClass="";return styleClass="data-node"===d.elementType?"node "+d.elementType+" "+d.dataNodeType:"node "+d.elementType}).attr("x",0).attr("y",0).attr("width",function(d){return d.width}).attr("height",function(d){return d.height}).attr("z-index",function(d){return d.zIndex}).attr("style",function(d){var style="";if(d.hasOwnProperty("fill")&&(style+="fill:"+d.fill+"; "),d.hasOwnProperty("fillOpacity")&&(style+="fill-opacity:"+d.fillOpacity+"; "),d.hasOwnProperty("stroke")&&(style+="stroke:"+d.stroke+"; "),d.hasOwnProperty("strokeWidth"))var strokeWidthEffective=2*d.strokeWidth;else var strokeWidthEffective=2;return style+="stroke-width:"+strokeWidthEffective+"; ",d.hasOwnProperty("strokeStyle")&&("dashed"===d.strokeStyle&&(style+="stroke-dasharray: 5,3; "),"double"===d.strokeStyle&&d3.select(nodesContainer[0][i]).append("use").attr("id",function(d){return"node-double"+d.graphId}).attr("class",function(d){var styleClass="";return styleClass="data-node"===d.elementType?"node "+d.elementType+" "+d.dataNodeType:"node "+d.elementType}).attr("transform",function(d){var transform="scale(1)";return d.hasOwnProperty("rotation")&&(transform="rotate("+d.rotation+" "+d.width/2+" "+d.height/2+")"),transform}).attr("x",function(){return strokeWidthEffective}).attr("y",function(){return strokeWidthEffective}).attr("width",function(d){return d.width-2*strokeWidthEffective}).attr("height",function(d){return d.height-2*strokeWidthEffective}).attr("xlink:xlink:href",function(d){return"#"+d.symbolType}).attr("style",function(){return style+"fill-opacity:0; "})),style});if(symbolsAvailable.filter(function(d,i){return symbolsAvailable[0][i].id===pathvisio.data.pathways[pathvisio.data.current.svgSelector].nodes[0].symbolType}).length>0?node.attr("xlink:xlink:href",function(d){return"#"+d.symbolType}):(node.attr("xlink:xlink:href","#rectangle"),console.log("Pathvisio.js does not have access to the requested symbol: "+pathvisio.data.pathways[pathvisio.data.current.svgSelector].nodes[0].symbolType+". Rectangle used as placeholder.")),d.hasOwnProperty("textLabel")){var nodeText=d3.select(this).append("text").attr("id",function(d){return"node-text-"+d.graphId}).attr("x",0).attr("y",0).attr("transform",function(d){if(d.textLabel.hasOwnProperty("textAnchor"))if("start"===d.textLabel.textAnchor)var dx=5;else if("end"===d.textLabel.textAnchor)var dx=d.width-5;else var dx=d.width/2;else var dx=d.width/2;if(d.textLabel.hasOwnProperty("vAlign"))if("top"===d.textLabel.vAlign)var dy=5+1*d.textLabel.fontSize;else if("bottom"===d.textLabel.vAlign)var dy=d.height-(5+.3*d.textLabel.fontSize+(pathvisio.helpers.splitStringByNewLine(d.textLabel.text).length-1)*d.textLabel.fontSize);else var dy=d.height/2+.3*d.textLabel.fontSize-(pathvisio.helpers.splitStringByNewLine(d.textLabel.text).length-1)*d.textLabel.fontSize/2;else var dy=d.height/2+.3*d.textLabel.fontSize-(pathvisio.helpers.splitStringByNewLine(d.textLabel.text).length-1)*d.textLabel.fontSize/2;return"translate("+dx+" "+dy+")"}).attr("class",function(d){var styleClass="";return"data-node"===d.elementType&&(styleClass=d.dataNodeType),styleClass}).attr("style",function(d){var style="";return d.fontSize,d.textLabel.hasOwnProperty("fill")&&(style+="fill:"+d.textLabel.fill+"; "),d.textLabel.hasOwnProperty("fontFamily")&&(style+="font-family:"+d.textLabel.fontFamily+"; "),d.textLabel.hasOwnProperty("fontSize")&&(style+="font-size:"+d.textLabel.fontSize+"px; "),d.textLabel.hasOwnProperty("fontWeight")&&(style+="font-weight:"+d.textLabel.fontWeight+"; "),d.textLabel.hasOwnProperty("fontStyle")&&(style+="font-style:"+d.textLabel.fontStyle+"; "),d.textLabel.hasOwnProperty("textAnchor")&&(style+="text-anchor:"+d.textLabel.textAnchor+"; "),style});nodeText.each(function(d){var fontSize=d.textLabel.fontSize;d3.select(this).selectAll("tspan").data(function(d){var textArray=pathvisio.helpers.splitStringByNewLine(d.textLabel.text);return textArray}).enter().append("tspan").attr("x",0).attr("y",function(d,i){return i*fontSize}).text(function(d){return d})}),d.hasOwnProperty("biopaxRefs")&&d3.select(this).selectAll(".node-publication-xref-text").data(d.biopaxRefs).enter().append("text").attr("id",function(d){return"node-publication-xref-text-"+d}).attr("x",0).attr("y",0).attr("transform",function(d,i){return"translate("+12*i+" "+-12+")"}).attr("class","node-publication-xref-text").attr("style","").text(function(d){var index=0,rdfId=null;do console.log("pathvisio.data.pathways[pathvisio.data.current.svgSelector].biopax"),console.log(pathvisio.data.pathways[pathvisio.data.current.svgSelector].biopax),rdfId=pathvisio.data.pathways[pathvisio.data.current.svgSelector].biopax.bpPublicationXrefs[index].rdfId,index+=1;
while(rdfId!==d.Text&&index<pathvisio.data.pathways[pathvisio.data.current.svgSelector].biopax.bpPublicationXrefs.length);return index})}})}function getPortCoordinates(boxDimensions,relX,relY){var port={};return port.x=boxDimensions.x+relX*boxDimensions.width,port.y=boxDimensions.y+relY*boxDimensions.height,port}var shapeMappings={Arc:"arc",Brace:"brace",Cell:"cell","Endoplasmic Reticulum":"endoplasmic-reticulum","Extracellular region":"extracellular-region","Golgi Apparatus":"golgi-apparatus",Hexagon:"hexagon","mim-degradation":"mim-degradation",Mitochondria:"mitochondria",Nucleus:"nucleus",Organelle:"organelle",Oval:"oval",Pentagon:"pentagon",Rectangle:"rectangle",RoundedRectangle:"rounded-rectangle","Sarcoplasmic Reticulum":"sarcoplasmic-reticulum",Triangle:"triangle",Vesicle:"vesicle"},alignToAnchorMappings={Left:"start",Center:"middle",Right:"end"};return{drawAll:drawAll,getPortCoordinates:getPortCoordinates,gpml2json:gpml2json}}(),pathvisio.pathway.edge=function(){function gpml2json(rawJsonEdges){function attachedToAnchor(point,edges){var i=-1;do{i+=1;var anchor=edges[i].anchors.filter(function(element){return element.graphId===point.graphRef})[0]}while(void 0===anchor&&i<edges.length-1);return void 0!==anchor}try{rawJsonEdges.forEach(function(element){if(element.graphics.hasOwnProperty("anchor")&&(element.anchors=pathvisio.helpers.convertToArray(element.graphics.anchor)),element.graphics.hasOwnProperty("color")){var color=new RGBColor(element.graphics.color);color.ok&&(element.stroke=color.toHex())}element.strokeWidth=element.graphics.lineThickness,element.graphics.hasOwnProperty("connectorType")&&(element.connectorType=element.graphics.connectorType.toLowerCase()),element.graphics.hasOwnProperty("lineStyle")?(element.strokeStyle=element.graphics.lineStyle.toLowerCase(),"broken"===element.strokeStyle&&(element.strokeStyle="dashed")):element.hasOwnProperty("attribute")&&"org.pathvisio.DoubleLineProperty"===element.attribute.key&&"Double"===element.attribute.value&&(element.strokeStyle="double",delete element.attribute),element.zIndex=element.graphics.zorder,element.hasOwnProperty("xref")&&(element.xref.database||element.xref.id?(element.xref=element.xRef,delete element.xref):delete element.xref);var points=pathvisio.helpers.convertToArray(element.graphics.point),pointsData=pathvisio.pathway.edge.point.gpml2json(points);element.points=pointsData.points,element.markerStart=pointsData.markerStart,element.markerEnd=pointsData.markerEnd,delete element.graphics}),rawJsonEdges.sort(function(a,b){return a.zIndex-b.zIndex});var edgesWithAnchors=[],edgesWithoutAnchors=[];rawJsonEdges.forEach(function(element){element.hasOwnProperty("anchors")?edgesWithAnchors.push(element):edgesWithoutAnchors.push(element)});var validJsonEdges=[],unsortedJsonEdges=edgesWithAnchors;unsortedJsonEdges.forEach(function(element,index,array){attachedToAnchor(element.points[0],edgesWithAnchors)||attachedToAnchor(element.points[element.points.length-1],edgesWithAnchors)||(validJsonEdges.push(element),array.splice(index,1))});do unsortedJsonEdges.forEach(function(element,index,array){attachedToAnchor(element.points[0],edgesWithAnchors)&&!attachedToAnchor(element.points[0],validJsonEdges)||!attachedToAnchor(element.points[element.points.length-1],validJsonEdges)&&attachedToAnchor(element.points[element.points.length-1],edgesWithAnchors)||(validJsonEdges.push(element),array.splice(index,1))});while(unsortedJsonEdges.length>0);return validJsonEdges=validJsonEdges.concat(edgesWithoutAnchors)}catch(e){return console.log("Error converting edge to json: "+e.message),e}}function drawAll(){if(pathvisio.data.pathways[pathvisio.data.current.svgSelector].hasOwnProperty("edges")){var pathData=null;pathvisio.data.current.svg.select("#viewport").selectAll("pathway.edge").data(pathvisio.data.pathways[pathvisio.data.current.svgSelector].edges).enter().append("path").attr("id",function(d){return d.edgeType+"-"+d.graphId}).attr("class",function(d){var styleClass="edge "+d.edgeType+" ";return d.hasOwnProperty("strokeStyle")&&"dashed"===d.strokeStyle&&(styleClass+=" dashed-stroke"),styleClass}).attr("d",function(d){return pathData=pathvisio.pathway.edge.pathData.get(d),d.hasOwnProperty("strokeStyle")&&"double"===d.strokeStyle&&pathvisio.data.current.svg.select("#viewport").append("path").attr("class",d.edgeType+"-double").attr("d",pathData).attr("class","drawing-board-color-stroke").attr("style","stroke-width:"+d.strokeWidth+"; ").attr("marker-start","url(#"+pathvisio.pathway.edge.marker.draw(d.markerStart,"start",d.stroke)+")").attr("marker-end","url(#"+pathvisio.pathway.edge.marker.draw(d.markerEnd,"end",d.stroke)+")"),pathData}).attr("style",function(d){var style="stroke-width:"+d.strokeWidth+"; ";return d.hasOwnProperty("stroke")&&(style+="stroke:"+d.stroke+"; "),d.hasOwnProperty("strokeStyle")&&"double"===d.strokeStyle&&(style+="stroke-width:"+3*d.strokeWidth+"; "),style}).attr("marker-start",function(d){return markerStart=pathvisio.pathway.edge.marker.draw(d.markerStart,"start",d.stroke),d.hasOwnProperty("strokeStyle")&&"double"===d.strokeStyle&&(markerStart="double-line-hack-start"),"url(#"+markerStart+")"}).attr("marker-end",function(d){return markerEnd=pathvisio.pathway.edge.marker.draw(d.markerEnd,"end",d.stroke),d.hasOwnProperty("strokeStyle")&&"double"===d.strokeStyle&&(markerEnd="double-line-hack-end"),"url(#"+markerEnd+")"}).attr("fill","none")}}return{gpml2json:gpml2json,drawAll:drawAll}}(),pathvisio.pathway.edge.marker=function(){function draw(name,position,color){var markerName="";if("none"===name)markerName=name;else if("#000"!==color&&"#000000"!==color&&color){var markerElementBlack=pathvisio.data.current.svg.select("marker#"+name+"-"+position+"-black"),markerElement=pathvisio.helpers.cloneNode(markerElementBlack[0][0]),markerElementStyle="";"black"===markerElement[0][0].getAttribute("stroke")&&(markerElementStyle+="stroke:"+color+"; "),"black"===markerElement[0][0].getAttribute("fill")&&(markerElementStyle+="fill:"+color+"; "),markerElement[0][0].setAttribute("id",name+"-"+position+"-"+color),markerElement[0][0].setAttribute("style",markerElementStyle),markerName=name+"-"+position+"-"+color}else markerName=name+"-"+position+"-black";return markerName}return{draw:draw}}(),pathvisio.pathway.edge.point=function(){function gpml2json(rawJsonPoints){try{var markerStart="none",markerEnd="none";rawJsonPoints.forEach(function(element,index,array){if(void 0!==element.graphRef){delete element.x,delete element.y;var relX=(Math.round(2*element.relX)/2).toString();element.relX=parseFloat(anchorPositionMappings[relX]);var relY=(Math.round(2*element.relY)/2).toString();element.relY=parseFloat(anchorPositionMappings[relY]),0===element.relX?element.dx=-1:1===element.relX?element.dx=1:0===element.relY?element.dy=-1:1===element.relY&&(element.dy=1)}0===index&&markerMappings.hasOwnProperty(element.arrowHead)?(markerStart=markerMappings[element.arrowHead],delete element.arrowHead):index===array.length-1&&markerMappings.hasOwnProperty(element.arrowHead)&&(markerEnd=markerMappings[element.arrowHead],delete element.arrowHead)});var validJsonPoints=rawJsonPoints;return{points:validJsonPoints,markerStart:markerStart,markerEnd:markerEnd}}catch(e){return console.log("Error converting point to json: "+e.message),e}}function getGraphRef(point){if(self.point=point,point.hasOwnProperty("graphRef")){if(pathvisio.data.pathways[pathvisio.data.current.svgSelector].hasOwnProperty("nodes")){var node=pathvisio.data.pathways[pathvisio.data.current.svgSelector].nodes.filter(function(element){return element.graphId===point.graphRef})[0];if(void 0!==node)return{type:"node",element:node}}if(pathvisio.data.pathways[pathvisio.data.current.svgSelector].hasOwnProperty("groups")){var group=pathvisio.data.pathways[pathvisio.data.current.svgSelector].groups.filter(function(element){return element.graphId===point.graphRef})[0];if(void 0!==group)return{type:"group",groupId:group.groupId}}var edgesWithAnchors=pathvisio.data.pathways[pathvisio.data.current.svgSelector].edges.filter(function(element){return element.hasOwnProperty("anchors")});self.edgesWithAnchors=edgesWithAnchors;var i=-1;do{i+=1;var anchor=edgesWithAnchors[i].anchors.filter(function(element){return element.graphId===point.graphRef})[0]}while(void 0===anchor&&i<edgesWithAnchors.length);return{type:"anchor",element:anchor,edge:edgesWithAnchors[i]}}return{type:"unconnected"}}function getCoordinates(point){var coordinates={},edgeTerminusRef=self.edgeTerminusRef=getGraphRef(point);if("anchor"!==edgeTerminusRef.type)if("unconnected"===edgeTerminusRef.type)coordinates.x=point.x,coordinates.y=point.y;else if("node"===edgeTerminusRef.type)var coordinates=pathvisio.pathway.node.getPortCoordinates(edgeTerminusRef.element,point.relX,point.relY);else{if("group"!==edgeTerminusRef.type)return"error";var groupDimensions=pathvisio.pathway.group.getDimensions(edgeTerminusRef.groupId),coordinates=pathvisio.pathway.node.getPortCoordinates(groupDimensions,point.relX,point.relY)}else var path=d3.select("#interaction-"+edgeTerminusRef.edge.graphId)[0][0],coordinates=path.getPointAtLength(edgeTerminusRef.element.position*path.getTotalLength());return coordinates}function isTwoPointElbow(source,target){var isRightAngle=Math.abs(source.dx)===Math.abs(target.dy)&&Math.abs(source.dy)===Math.abs(target.dx),sourcePasses=(target.x-source.x)/Math.abs(target.x-source.x)===source.dx||(target.y-source.y)/Math.abs(target.y-source.y)===source.dy,targetPasses=(source.x-target.x)/Math.abs(source.x-target.x)===target.dx||(source.y-target.y)/Math.abs(source.y-target.y)===target.dy;return isRightAngle&&sourcePasses&&targetPasses}var anchorPositionMappings={"-1":0,"-0.5":.333,0:.5,.5:.667,1:1},markerMappings={Arrow:"arrow","mim-branching-left":"mim-branching-left","mim-branching-right":"mim-branching-right","mim-necessary-stimulation":"mim-necessary-stimulation","mim-binding":"mim-binding","mim-conversion":"mim-conversion","mim-stimulation":"mim-stimulation","mim-modification":"mim-modification","mim-catalysis":"mim-catalysis","mim-inhibition":"mim-inhibition","mim-cleavage":"mim-cleavage","mim-covalent-bond":"mim-covalent-bond","mim-transcription-translation":"mim-transcription-translation","mim-gap":"mim-gap",none:"none",TBar:"t-bar"};return{getGraphRef:getGraphRef,getCoordinates:getCoordinates,isTwoPointElbow:isTwoPointElbow,gpml2json:gpml2json}}(),pathvisio.pathway.edge.pathData=function(){function get(d){function switchDirection(currentDirection){return"H"===currentDirection?"V":"H"}var sourcePoint=d.points[0],source=pathvisio.pathway.edge.point.getCoordinates(sourcePoint);source.dx=void 0===sourcePoint.dx?0:sourcePoint.dx,source.dy=void 0===sourcePoint.dy?0:sourcePoint.dy;var targetPoint=d.points[d.points.length-1],target=pathvisio.pathway.edge.point.getCoordinates(targetPoint);target.dx=void 0===targetPoint.dx?0:targetPoint.dx,target.dy=void 0===targetPoint.dy?0:targetPoint.dy;var pathData="M "+source.x+" "+source.y;if(d.connectorType&&void 0!==d.connectorType&&"straight"!==d.connectorType)if("elbow"===d.connectorType&&d.points[0].hasOwnProperty("graphRef")&&d.points[d.points.length-1].hasOwnProperty("graphRef"))currentDirection=1===Math.abs(source.dx)?"H":"V",2===d.points.length&&pathvisio.pathway.edge.point.isTwoPointElbow(source,target)||(d.points.length>2?d.points.forEach(function(element,index,array){index>0&&index<array.length-1&&(pathData+="H"===currentDirection?" "+currentDirection+" "+element.x:" "+currentDirection+" "+element.y,currentDirection=switchDirection(currentDirection))}):(1===Math.abs(source.dx)?pathData+=" H "+(source.x+15*source.dx):1===Math.abs(source.dy)&&(pathData+=" V "+(source.y+15*source.dy),currentDirection=switchDirection(currentDirection)),target.dx===(target.x-source.x)/Math.abs(target.x-source.x)||source.dx===target.dy||source.dy===target.dx?(pathData+=" H "+(target.x+15*target.dx)+" V "+target.y+" H "+target.x,currentDirection=switchDirection(currentDirection)):(target.dy===(target.y-source.y)/Math.abs(target.y-source.y)||source.dx===target.dy||source.dy===target.dx)&&(pathData+=" V "+(target.y+15*target.dy)+" H "+target.x+" V "+target.y,currentDirection=switchDirection(currentDirection)))),"H"===currentDirection?(pathData+=" "+currentDirection+" "+target.x,currentDirection=switchDirection(currentDirection),pathData+=" "+currentDirection+" "+target.y,currentDirection=switchDirection(currentDirection)):(pathData+=" "+currentDirection+" "+target.y,currentDirection=switchDirection(currentDirection),pathData+=" "+currentDirection+" "+target.x,currentDirection=switchDirection(currentDirection));else if("segmented"===d.connectorType)d.points.forEach(function(element,index,array){index>0&&index<array.length-1&&(pathData+=" L "+element.x+" "+element.y)}),pathData+=" L "+target.x+" "+target.y;else{if("curved"===d.connectorType){if(3===d.points.length){var pointControl=d.points[1];return pathData+=" S"+pointControl.x+","+pointControl.y+" "+target.x+","+target.y}return pathData+=" T"+target.x+","+target.y}console.log("Warning: pathvisio.js does not support connector type: "+d.connectorType),d.points.forEach(function(element,index,array){index>0&&index<array.length-1&&(pathData+=" L "+element.x+" "+element.y)}),pathData+=" L "+target.x+" "+target.y}else pathData+=" L "+target.x+" "+target.y;return pathData}return{get:get}}(),pathvisio.pathway.xRef=function(){function getData(species,database,id,callback){var databaseId=dataSources.filter(function(element){return element.database===database})[0].id,url="../data/xrefs.php?species="+encodeURIComponent(species)+"&database="+encodeURIComponent(databaseId)+"&id="+encodeURIComponent(id);console.log("url"),console.log(url),$.ajax({url:url,dataType:"text",success:function(data){console.log(data),self.data=data,callback(data)}})}function displayData(id){var pathway=pathvisio.data.pathways[pathvisio.data.current.svgSelector],node=pathway.nodes.filter(function(element){return element.graphId==id})[0];getData(pathway.organism,node.xRef.database,node.xRef.id,function(data){var parser=CSVParser.parse(data,!0," ",!1,!1,"."),parsed=DataGridRenderer.json(parser.dataGrid,parser.headerNames,parser.headerTypes,"	","\n"),xRefDataParsed=self.xRefDataParsed=JSON.parse(parsed);console.log(xRefDataParsed);var features={id:node.dataNodeType+" "+node.textLabel.text,description:node.xRef.database+" "+node.xRef.id};xRefDataParsed.forEach(function(element){features[element.database]=element.id});var detailsFrame=d3.select("#detailsFrame");detailsFrame[0][0].style.visibility="visible",Biojs.DetailsFrame.set?(detailsFrame.selectAll("*").remove(),Biojs.DetailsFrame.instance=new Biojs.DetailsFrame({target:"detailsFrame",features:features})):(Biojs.DetailsFrame.set=!0,Biojs.DetailsFrame.instance=new Biojs.DetailsFrame({target:"detailsFrame",features:features}))})}var dataSources=[{database:"Affy",id:"X",url:"https://www.affymetrix.com/LinkServlet?probeset=$id",name:"Affymetrix Probeset"},{database:"Agilent",id:"Ag",url:"",name:"Agilent"},{database:"BIND",id:"Bi",url:"http://www.bind.ca/Action?identifier=bindid&idsearch=$id",name:"BIND"},{database:"BioCyc",id:"Bc",url:"http://biocyc.org/getid?id=$id",name:"BioCyc"},{database:"BioGrid",id:"Bg",url:"http://thebiogrid.org/$id",name:"BioGRID"},{database:"BioModels Database",id:"Bm",url:"http://www.ebi.ac.uk/biomodels-main/$id",name:"BioModels Database"},{database:"BioSystems",id:"Bs",url:"http://www.ncbi.nlm.nih.gov/biosystems/$id",name:"BioSystems"},{database:"BRENDA",id:"Br",url:"http://www.brenda-enzymes.org/php/result_flat.php4?ecno=$id",name:"BRENDA"},{database:"CAS",id:"Ca",url:"http://commonchemistry.org/ChemicalDetail.aspx?ref=$id",name:"CAS"},{database:"CCDS",id:"Cc",url:"http://www.ncbi.nlm.nih.gov/CCDS/CcdsBrowse.cgi?REQUEST=ALLFIELDS&DATA=$id",name:"CCDS"},{database:"ChEBI",id:"Ce",url:"http://www.ebi.ac.uk/chebi/searchId.do?chebiId=$id",name:"ChEBI"},{database:"Chemspider",id:"Cs",url:"http://www.chemspider.com/Chemical-Structure.$id.html",name:"ChemSpider"},{database:"CodeLink",id:"Ge",url:"",name:"CodeLink"},{database:"Database of Interacting Proteins",id:"Dip",url:"http://dip.doe-mbi.ucla.edu/dip/DIPview.cgi?ID=$id",name:"Database of Interacting Proteins"},{database:"dbSNP",id:"Sn",url:"http://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?rs=$id",name:"dbSNP"},{database:"DrugBank",id:"Dr",url:"http://www.drugbank.ca/drugs/$id",name:"DrugBank"},{database:"EcoCyc",id:"Eco",url:"http://ecocyc.org/ECOLI/NEW-IMAGE?type=NIL&object=$id",name:"EcoCyc"},{database:"EcoGene",id:"Ec",url:"http://ecogene.org/geneInfo.php?eg_id=$id",name:"EcoGene"},{database:"EMBL",id:"Em",url:"http://www.ebi.ac.uk/ena/data/view/$id",name:"European Nucleotide Archive"},{database:"Ensembl",id:"En",url:"http://www.ensembl.org/id/$id",name:"Ensembl"},{database:"Ensembl B. subtilis",id:"EnBs",url:"http://bacteria.ensembl.org/Bacillus/B_subtilis/Gene/Summary?g=$id",name:"Ensembl"},{database:"Ensembl C. elegans",id:"EnCe",url:"http://www.ensembl.org/Caenorhabditis_elegans/Gene/Summary?g=$id",name:"Ensembl"},{database:"Ensembl Chicken",id:"EnGg",url:"http://www.ensembl.org/Gallus_gallus/Gene/Summary?g=$id",name:"Ensembl"},{database:"Ensembl Chimp",id:"EnPt",url:"http://www.ensembl.org/Pan_troglodytes/Gene/Summary?g=$id",name:"Ensembl"},{database:"Ensembl Cow",id:"EnBt",url:"http://www.ensembl.org/Bos_taurus/Gene/Summary?g=$id",name:"Ensembl"},{database:"Ensembl Dog",id:"EnCf",url:"http://www.ensembl.org/Canis_familiaris/Gene/Summary?g=$id",name:"Ensembl"},{database:"Ensembl E. coli",id:"EnEc",url:"http://bacteria.ensembl.org/Escherichia_Shigella/E_coli_K12/Gene/Summary?g=$id",name:"Ensembl"},{database:"Ensembl Fruitfly",id:"EnDm",url:"http://www.ensembl.org/Drosophila_melanogaster/Gene/Summary?g=$id",name:"Ensembl"},{database:"Ensembl Horse",id:"EnQc",url:"http://www.ensembl.org/Equus_caballus/Gene/Summary?g=$id",name:"Ensembl"},{database:"Ensembl Human",id:"EnHs",url:"http://www.ensembl.org/Homo_sapiens/Gene/Summary?g=$id",name:"Ensembl"},{database:"Ensembl M. tuberculosis",id:"EnMx",url:"http://bacteria.ensembl.org/Mycobacterium/M_tuberculosis_H37Rv/Gene/Summary?g=$id",name:"Ensembl"},{database:"Ensembl Mosquito",id:"EnAg",url:"http://www.ensembl.org/Anopheles_gambiae/Gene/Summary?_q=$id",name:"Ensembl"},{database:"Ensembl Mouse",id:"EnMm",url:"http://www.ensembl.org/Mus_musculus/Gene/Summary?g=$id",name:"Ensembl"},{database:"Ensembl Pig",id:"EnSs",url:"http://www.ensembl.org/Sus_scrofa/Gene/Summary?g=$id",name:"Ensembl"},{database:"Ensembl Plants",id:"EP",url:"http://plants.ensembl.org/id/$id",name:"Ensembl Plants"},{database:"Ensembl Rat",id:"EnRn",url:"http://www.ensembl.org/Rattus_norvegicus/Gene/Summary?g=$id",name:"Ensembl"},{database:"Ensembl Xenopus",id:"EnXt",url:"http://www.ensembl.org/Xenopus_tropicalis/Gene/Summary?g=$id",name:"Ensembl"},{database:"Ensembl Yeast",id:"EnSc",url:"http://www.ensembl.org/Saccharomyces_cerevisiae/Gene/Summary?g=$id",name:"Ensembl"},{database:"Ensembl Zebrafish",id:"EnDr",url:"http://www.ensembl.org/Danio_rerio/Gene/Summary?g=$id",name:"Ensembl"},{database:"Entrez Gene",id:"L",url:"http://www.ncbi.nlm.nih.gov/gene/$id",name:"Entrez Gene"},{database:"Enzyme Nomenclature",id:"E",url:"http://www.ebi.ac.uk/intenz/query?cmd=SearchEC&ec=$id",name:"Enzyme Nomenclature"},{database:"FlyBase",id:"F",url:"http://flybase.org/reports/$id.html",name:"FlyBase"},{database:"GenBank",id:"G",url:"http://www.ncbi.nlm.nih.gov/nuccore/$id",name:"GenBank"},{database:"Gene Wiki",id:"Gw",url:"http://plugins.biogps.org/cgi-bin/wp.cgi?id=$id",name:"Gene Wiki"},{database:"GeneOntology",id:"T",url:"http://www.ebi.ac.uk/QuickGO/GTerm?id=$id",name:"Gene Ontology"},{database:"Gramene Arabidopsis",id:"EnAt",url:"http://www.gramene.org/Arabidopsis_thaliana/Gene/Summary?g=$id",name:"Grameen Arabidopsis"},{database:"Gramene Genes DB",id:"Gg",url:"http://www.gramene.org/db/genes/search_gene?acc=$id",name:"Gramene Genes"},{database:"Gramene Literature",id:"Gl",url:"http://www.gramene.org/db/literature/pub_search?ref_id=$id",name:"Gramene Literature"},{database:"Gramene Maize",id:"EnZm",url:"http://www.maizesequence.org/Zea_mays/Gene/Summary?g=$id",name:"Gramene Maize"},{database:"Gramene Pathway",id:"Gp",url:"",name:"Gramene Pathway"},{database:"Gramene Rice",id:"EnOj",url:"http://www.gramene.org/Oryza_sativa/Gene/Summary?db=core;g=$id",name:"Gramene Rice"},{database:"HGNC",id:"H",url:"http://www.genenames.org/data/hgnc_data.php?match=$id",name:"HGNC Symbol"},{database:"HGNC Accession number",id:"Hac",url:"http://www.genenames.org/data/hgnc_data.php?hgnc_id=$id",name:"HGNC"},{database:"HMDB",id:"Ch",url:"http://www.hmdb.ca/metabolites/$id",name:"HMDB"},{database:"HomoloGene",id:"Hg",url:"http://www.ncbi.nlm.nih.gov/homologene/$id",name:"HomoloGene"},{database:"HPRD",id:"Hp",url:"",name:"HPRD"},{database:"Illumina",id:"Il",url:"",name:"Illumina"},{database:"IntAct",id:"Ia",url:"http://www.ebi.ac.uk/intact/pages/details/details.xhtml?interactionAc=$id",name:"IntAct"},{database:"InterPro",id:"I",url:"http://www.ebi.ac.uk/interpro/DisplayIproEntry?ac=$id",name:"InterPro"},{database:"IPI",id:"Ip",url:"http://www.ebi.ac.uk/cgi-bin/dbfetch?db=IPI&id=$id&format=default",name:"IPI"},{database:"IRGSP Gene",id:"Ir",url:"",name:"IRGSP Gene"},{database:"Kegg Compound",id:"Ck",url:"http://www.genome.jp/dbget-bin/www_bget?cpd:$id",name:"KEGG Compound"},{database:"KEGG Drug",id:"Kd",url:"http://www.genome.jp/dbget-bin/www_bget?dr:$id",name:"KEGG Drug"},{database:"KEGG Genes",id:"Kg",url:"http://www.genome.jp/dbget-bin/www_bget?$id",name:"KEGG Genes"},{database:"KEGG Glycan",id:"Kgl",url:"http://www.genome.jp/dbget-bin/www_bget?gl:$id",name:"KEGG Glycan"},{database:"KEGG Pathway",id:"Kp",url:"http://www.genome.jp/dbget-bin/www_bget?pathway+$id",name:"KEGG Pathway"},{database:"KEGG Reaction",id:"Kr",url:"http://www.genome.jp/dbget-bin/www_bget?rn:$id",name:"KEGG Reaction"},{database:"LIPID MAPS",id:"Lm",url:"http://www.lipidmaps.org/data/get_lm_lipids_dbgif.php?LM_ID=$id",name:"LIPID MAPS"},{database:"LipidBank",id:"Lb",url:"http://lipidbank.jp/cgi-bin/detail.cgi?id=$id",name:"LipidBank"},{database:"MACiE",id:"Ma",url:"http://www.ebi.ac.uk/thornton-srv/databases/cgi-bin/MACiE/entry/getPage.pl?id=$id",name:"MACiE"},{database:"MaizeGDB",id:"Mg",url:"http://www.maizegdb.org/cgi-bin/displaylocusresults.cgi?term=$id",name:"MaizeGDB"},{database:"MatrixDB",id:"Md",url:"http://matrixdb.ibcp.fr/cgi-bin/model/report/default?name=$id&class=Association",name:"MatrixDB"},{database:"MetaCyc",id:"Mc",url:"http://www.metacyc.org/META/NEW-IMAGE?type=NIL&object=$id",name:"MetaCyc"},{database:"MGI",id:"M",url:"http://www.informatics.jax.org/marker/$id",name:"Mouse Genome Database"},{database:"MINT",id:"Mi",url:"http://mint.bio.uniroma2.it/mint/search/inFrameInteraction.do?interactionAc=$id",name:"MINT"},{database:"miRBase mature sequence",id:"Mbm",url:"http://www.mirbase.org/cgi-bin/mature.pl?mature_acc=$id",name:"miRBase mature sequence"},{database:"miRBase Sequence",id:"Mb",url:"http://microrna.sanger.ac.uk/cgi-bin/sequences/mirna_entry.pl?acc=$id",name:"miRBase Sequence"},{database:"NASC Gene",id:"N",url:"",name:"NASC Gene"},{database:"NCBI Protein",id:"Np",url:"http://www.ncbi.nlm.nih.gov/protein/$id",name:"NCBI Protein"},{database:"NCI Pathway Interaction Database",id:"Pid",url:"http://pid.nci.nih.gov/search/pathway_landing.shtml?what=graphic&jpg=on&pathway_id=$id",name:"NCI Pathway Interaction Database"},{database:"NuGO wiki",id:"Nw",url:"http://wiki.nugo.org/index.php/$id",name:"NuGO wiki"},{database:"OMIM",id:"Om",url:"http://omim.org/entry/$id",name:"OMIM"},{database:"Oryzabase",id:"Ob",url:"http://www.shigen.nig.ac.jp/rice/oryzabase/gateway/gatewayAction.do?target=symbol&id=$id",name:"Oryzabase"},{database:"Other",id:"O",url:"",name:"Other"},{database:"Pathway Commons",id:"Pc",url:"http://www.pathwaycommons.org/pc/record2.do?id=$id",name:"Pathway Commons"},{database:"PDB",id:"Pd",url:"http://www.rcsb.org/pdb/explore/explore.do?structureId=$id",name:"Protein Data Bank"},{database:"Pfam",id:"Pf",url:"http://pfam.sanger.ac.uk/family/$id/",name:"Pfam"},{database:"PharmGKB Drug",id:"Pgd",url:"http://www.pharmgkb.org/drug/$id",name:"PharmGKB Drug"},{database:"PharmGKB Gene",id:"Pgg",url:"http://www.pharmgkb.org/gene/$id",name:"PharmGKB Gene"},{database:"PharmGKB Pathways",id:"Pgp",url:"http://www.pharmgkb.org/pathway/$id",name:"PharmGKB Pathways"},{database:"PhosphoSite Protein",id:"Pp",url:"http://www.phosphosite.org/proteinAction.do?id=$id",name:"PhosphoSite Protein"},{database:"PINA",id:"Pi",url:"http://cbg.garvan.unsw.edu.au/pina/interactome.oneP.do?ac=$id&showExtend=null",name:"PINA"},{database:"PlantGDB",id:"Pl",url:"",name:"PlantGDB"},{database:"PubChem-bioassay",id:"Cpb",url:"http://pubchem.ncbi.nlm.nih.gov/assay/assay.cgi?aid=$id",name:"PubChem-bioassay"},{database:"PubChem-compound",id:"Cpc",url:"http://pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=$id",name:"PubChem-compound"},{database:"PubChem-substance",id:"Cps",url:"http://pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?sid=$id",name:"PubChem-substance"},{database:"Reactome",id:"Re",url:"http://www.reactome.org/cgi-bin/eventbrowser_st_id?FROM_REACTOME=1&ST_ID=$id",name:"Reactome"},{database:"RefSeq",id:"Q",url:"http://www.ncbi.nlm.nih.gov/entrez/viewer.fcgi?val=$id",name:"RefSeq"},{database:"RESID",id:"Res",url:"http://srs.ebi.ac.uk/srsbin/cgi-bin/wgetz?-id+6JSUg1NA6u4+-e+[RESID:'$id']",name:"RESID"},{database:"Rfam",id:"Rf",url:"http://www.sanger.ac.uk/cgi-bin/Rfam/getacc?$id",name:"RFAM"},{database:"RGD",id:"R",url:"http://rgd.mcw.edu/tools/genes/genes_view.cgi?id=$id",name:"Rat Genome Database"},{database:"Rhea",id:"Rh",url:"http://www.ebi.ac.uk/rhea/reaction.xhtml?id=$id",name:"Rhea"},{database:"Rice Ensembl Gene",id:"Os",url:"http://www.gramene.org/Oryza_sativa/geneview?gene=$id",name:"Rice Ensembl Gene"},{database:"SGD",id:"D",url:"http://www.yeastgenome.org/cgi-bin/locus.fpl?dbid=$id",name:"SGD"},{database:"Small Molecule Pathway Database",id:"Sm",url:"http://pathman.smpdb.ca/pathways/$id/pathway",name:"Small Molecule Pathway Database"},{database:"SMART",id:"Sma",url:"http://smart.embl-heidelberg.de/smart/do_annotation.pl?DOMAIN=$id",name:"SMART"},{database:"SPIKE",id:"Sk",url:"http://www.cs.tau.ac.il/~spike/maps/$id.html",name:"SPIKE Map"},{database:"SPRINT",id:"Spr",url:"http://www.bioinf.manchester.ac.uk/cgi-bin/dbbrowser/sprint/searchprintss.cgi?prints_accn=$id&display_opts=Prints&category=None&queryform=false&regexpr=off",name:"SPRINT"},{database:"STRING",id:"Str",url:"http://string.embl.de/interactions/$id",name:"STRING"},{database:"SubstrateDB",id:"Sdb",url:"http://substrate.burnham.org/protein/annotation/$id/html",name:"SubstrateDB"},{database:"SubtiWiki",id:"Sw",url:"http://www.subtiwiki.uni-goettingen.de/wiki/index.php/$id",name:"SubtiWiki"},{database:"SUPFAM",id:"Sf",url:"http://supfam.org/SUPERFAMILY/cgi-bin/scop.cgi?ipid=$id",name:"SUPFAM"},{database:"SWISS-MODEL",id:"Sw",url:"http://swissmodel.expasy.org/repository/smr.php?sptr_ac=$id",name:"SWISS-MODEL"},{database:"Systems Biology Ontology",id:"Sbo",url:"http://www.ebi.ac.uk/sbo/main/$id",name:"Systems Biology Ontology"},{database:"TAIR",id:"A",url:"http://arabidopsis.org/servlets/TairObject?type=locus&name=$id",name:"TAIR Locus"},{database:"TIGR",id:"Ti",url:"",name:"TIGR"},{database:"TTD Drug",id:"Td",url:"http://bidd.nus.edu.sg/group/cjttd/ZFTTDDRUG.asp?ID=$id",name:"TTD Drug"},{database:"TTD Target",id:"Tt",url:"http://bidd.nus.edu.sg/group/cjttd/ZFTTDDetail.asp?ID=$id",name:"TTD Target"},{database:"TubercuList",id:"Tb",url:"http://tuberculist.epfl.ch/quicksearch.php?gene+name=$id",name:"TubercuList"},{database:"UCSC Genome Browser",id:"Uc",url:"http://genome.ucsc.edu/cgi-bin/hgTracks?position=$id",name:"UCSC Genome Browser"},{database:"UniGene",id:"U",url:"http://www.ncbi.nlm.nih.gov/UniGene/clust.cgi?UGID=1548618&SEARCH=$id",name:"UniGene"},{database:"Unipathway",id:"Up",url:"http://www.grenoble.prabi.fr/obiwarehouse/unipathway/upa?upid=$id",name:"Unipathway"},{database:"Uniprot-TrEMBL",id:"S",url:"http://www.uniprot.org/uniprot/$id",name:"UniProtKB/TrEMBL"},{database:"Uniprot-SwissProt",id:"Sp",url:"http://www.uniprot.org/uniprot/$id",name:"UniProtKB/Swiss-Prot"},{database:"Wheat gene names",id:"Wn",url:"http://wheat.pw.usda.gov/report?class=gene;name=$id",name:"Wheat gene names"},{database:"Wheat gene refs",id:"Wr",url:"http://wheat.pw.usda.gov/cgi-bin/graingenes/report.cgi?class=reference&name=$id",name:"Wheat gene refs"},{database:"WikiGenes",id:"Wg",url:"http://www.wikigenes.org/e/gene/e/$id.html",name:"WikiGenes"},{database:"WikiPathways",id:"Wp",url:"http://www.wikipathways.org/index.php/Pathway:$id",name:"WikiPathways"},{database:"Wikipedia",id:"Wi",url:"http://en.wikipedia.org/wiki/$id",name:"Wikipedia"},{database:"WormBase",id:"W",url:"http://www.wormbase.org/db/gene/gene?name=$id;class=Gene",name:"WormBase"},{database:"ZFIN",id:"Z",url:"http://zfin.org/action/marker/view/$id",name:"ZFIN Gene"}];return{getData:getData,displayData:displayData}}();