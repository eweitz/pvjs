<!DOCTYPE html>
<html style="margin: 0; width: 100%; height: 100%; ">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">

    <title>BridgeDb Xref Search Template</title>

    <style type="text/css">
      html, body, x-layout{width: 100%;height: 100%;margin: 0;}
    </style>

    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

    <script src="http://www.x-tags.org/js/x-tag-components.js"></script>
    <script src="https://rawgit.com/caolan/highland/master/dist/highland.js"></script>
    <script src="https://rawgit.com/davidjbradshaw/iframe-resizer/master/js/iframeResizer.contentWindow.min.js"></script>
    <script src="https://bridgedb.github.io/bridgedbjs/dist/bridgedb-4.0.0.min.js"></script>

  </head>
  <body>

    <form class="form-search">
      <div>
        <input on-blur="loadOptions(requestedAttribute)" type="text" placeholder="Search by name">
        <button type="submit" on-click="open('lg')">
          <span class="fa fa-search" aria-hidden="true"></span>
        </button>
      </div>
    </form>

    <script>
      function sendMessage(message) {
        if ('parentIFrame' in window) {
          //parentIFrame.close();
          parentIFrame.sendMessage(message);
        }
      }
      var bridgedb = BridgeDb({
        baseIri: 'http://pointer.ucsf.edu/d3/r/data-sources/bridgedb.php/',
        datasetsMetadataIri: 'http://pointer.ucsf.edu/d3/r/data-sources/bridgedb-datasources.php',
        organism: 'Homo sapiens'
      });

      bridgedb.entityReference.freeSearch({attribute: 'Nfkb1'})
      .filter(function(searchResult) {
        return searchResult.isDataItemIn._isPrimary;
      })
      .reduce('', function(accumulator, searchResult) {
        accumulator += '<br>' + searchResult.db;
        return accumulator;
      })
      .each(function(innerHtmlString) {
        sendMessage(innerHtmlString);
      });
    </script>

  </body>
</html>
